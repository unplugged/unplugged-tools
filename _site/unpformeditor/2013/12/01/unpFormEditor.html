<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>UnpFormEditor</title>
    <meta name="charset" content="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="http://codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="/unplugged-tools/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/unplugged-tools/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/unplugged-tools/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/unplugged-tools/css/glyphicons.css">
  </head>
  <body class="homepage">
    <div class="row header">
      <div class="container">
        <h1><a id="view:_id2:homelink" href="/index.html" title="Unplugged Controls">Unplugged Controls</a></h1>
        <ul class="buttons">
          <li><a href="/index.html">Home</a></li>
          <li><a href="/documentation.html">Documentation</a></li>
        </ul>
      </div>
    </div>
    <div class="row footer">
    <div class="container">
		<h2>UnpFormEditor</h2>

		<div class="post">
			<h1 id='function'>Function</h1>

<p>This control is a wrapper to handle the validation and saving of your document which is in edit mode. <img alt='Form Editor' src='http://teamstudio.s3.amazonaws.com/formeditor.png' /> <img alt='Form Editor' src='http://teamstudio.s3.amazonaws.com/formeditor_small.png' /></p>

<h1 id='usage'>Usage</h1>

<p>Firstly set up a document data binding on your XPage and make sure it is called document1</p>

<p>Drag the control onto your XPage and set the following Custom Properties:</p>

<ul>
<li>closexpagename: the name of the XPage to open when clicking the close button. This page is loaded with a</li>

<li>dbName: optional parameter to specify which database the document you want to open is located in. The database path should be delimited with forward slashes (e.g. mydir/mydb.nsf). Leave blank for the same db</li>

<li>formname: the name of the Notes form which the document will be saved as (for when creating a new document)</li>

<li>position: if a <span><span>UnpNavigator</span></span> is used the position needs to be set to &#8216;menu-aligned&#8217; to allow for the navigator column to be displayed on tablets in landscape mode. &#8216;left-aligned&#8217; will set the data to the left of the device regardless of the navigator included or not</li>

<li>showbuttons: boolean setting to control whether to display standard buttons. full refresh, so should contain Header / Footer / Navigator as required.</li>

<li>title: the title to display at the top of the page</li>

<li>viewxpagename: the name of the XPage to open after clicking the Save button. <em>At the moment this property is not being used</em> (it will be opened with ?action=openDocument&amp;documentId=<span>unid</span> )</li>
</ul>

<p>Once the control is added, drag a panel into the editable area which will contain the fields you want to display.</p>

<p>The example XML below shows an example of a simple text field. It is important that the ID of the control matches the name of the field to be stored on the document.</p>
<pre class='CICodeFormatter'><code class='CICodeFormatter'> &lt;xc:unpFormEditor showbuttons="true" closexpagename="UnpDemoWidgets.xsp"  
      viewxpagename="Employee.xsp" formname="Employee" title="Employee"&gt;  
      &lt;xp:this.facets&gt;  
           &lt;xp:panel xp:key="facet_1"&gt;  
                &lt;xp:label value="Name" id="namelabel" for="name"&gt;&lt;/xp:label&gt;  
                &lt;xp:inputText id="name" value="#{document1.Name}"  
                     styleClass="required deletable"&gt;  
                &lt;/xp:inputText&gt;  
           &lt;/xp:panel&gt;  
      &lt;/xp:this.facets&gt;  
 &lt;/xc:unpFormEditor&gt;  
</code></pre>
<p>If you want the field to be mandatory, add a styleClass property of &#8220;required&#8221;. If you want the field to include an &#8216;x&#8217; so the contents can be deleted, add a styleClass property of &#8220;deletable&#8221;.</p>

<p>If you want to store a multi value field (for example using a List Box control), the name of the field will need to be prefixed &#8220;multi__&#8221; (that is two underscores acting as a delimiter) so an example field might look like:</p>
<pre class='CICodeFormatter'><code class='CICodeFormatter'> &lt;xp:listBox id="multi__categories" multiple="true"  
      value="#{document1.Categories}"&gt;  
      &lt;xp:selectItem itemLabel=" " itemValue=""&gt;&lt;/xp:selectItem&gt;  
      &lt;xp:selectItems&gt;  
           &lt;xp:this.value&gt;&lt;![CDATA[#{javascript:var doc:NotesDocument = database.getView("MissionLookup").getFirstDocument();  
 var out = doc.getItemValue("Categories");  
 return out;}]]&gt;&lt;/xp:this.value&gt;  
      &lt;/xp:selectItems&gt;  
 &lt;/xp:listBox&gt;  
</code></pre>
<p>You can use <span><span>Generic Classes</span></span> to layout the content of your pages.</p>

<h2 id='autocomplete_fields'>Autocomplete Fields</h2>

<p>To enable auto complete on a field, there are 3 steps required. Firstly, add the CSS class &#8220;autocomplete&#8221; to the styleClass property of the field.</p>

<p>Secondly, add an attribute to the field called &#8220;auto-src&#8221; with a value which is a URL which will return a list of suggestions separated by line breaks.</p>

<p>Normally you would return this list from another XPages using the &#8220;headless XPages technique&#8221; (sometimes known and XAgents). So as an example the following XML uses an XPage called EmployeeEditDeptAuto.xsp</p>
<pre class='CICodeFormatter'><code class='CICodeFormatter'> &lt;xp:inputText id="dept" value="#{document1.Dept}"  
      styleClass="required xspInputFieldEditBox deletable autocomplete"&gt;  
      &lt;xp:this.attrs&gt;  
           &lt;xp:attr name="auto-src" value="EmployeeEditDeptAuto.xsp"&gt;  
           &lt;/xp:attr&gt;  
      &lt;/xp:this.attrs&gt;  
 &lt;/xp:inputText&gt;  
</code></pre>
<p>The XPage simply returns a list of options:</p>
<pre class='CICodeFormatter'><code class='CICodeFormatter'> &lt;?xml version="1.0" encoding="UTF-8"?&gt;  
 &lt;xp:view xmlns:xp="http://www.ibm.com/xsp/core" rendered="false"&gt;  
      &lt;xp:this.afterRenderResponse&gt;&lt;![CDATA[#{javascript:var exCon = facesContext.getExternalContext();   
 var writer = facesContext.getResponseWriter();  
 var response = exCon.getResponse();  
 response.setContentType("text/plain");  
 response.setHeader("Cache-Control", "no-cache");  
 var list = $A(@Unique(@DbLookup(@DbName(), "Employees by dept", context.getUrlParameter("q"), 1, "[PARTIALMATCH]"))).sort();  
 var out = "";  
 for (var i=0; i&lt;list.length; i++){  
      out += list[i] + "\n";       
 }  
 writer.write(out);  
 writer.endDocument();  
 facesContext.responseComplete();}]]&gt;&lt;/xp:this.afterRenderResponse&gt;  
      &lt;xp:this.resources&gt;  
           &lt;xp:script src="/unpCommon.jss" clientSide="false"&gt;&lt;/xp:script&gt;  
      &lt;/xp:this.resources&gt;  
 &lt;/xp:view&gt;  
</code></pre>
<h1 id='required_resources'>Required Resources</h1>

<p>When you use the Form Editor custom control make sure that you have the following resources in your application:</p>

<ul>
<li>UnpSaveDocument (XPage)</li>

<li>unplugged.css</li>

<li>unp/jquery-1.7.2.min.js</li>

<li>unp/jquery.blockUI.min.js</li>

<li>unp/iScroll.min.js</li>

<li>unplugged.js</li>

<li>unpCommon.jss</li>
</ul>
	  	</div>
	</div>
</div>

  </body>
</html>